%??? P50?RRP?????????
%input
%Li,Lj---i,j???
%xb,yb---B????
%xc,yc-----C????
%xsi,ysi---i?????si??
%xsj,ysj---j?????sj??
%ddxsi,ddysi---i?????si????
%ddxsj,ddysj---j?????sj????
%ddthetai ---i??????
%phij ---j?????????,?????4-3?
%mi,mj---??i,j???
%Ji ---??i????
%Fpxi,Fpyi----???i???????
%Ti---???i??????
%Fpxj,Fpyj----???j???????
%Tj---???j??????
%
%output
%Frxb,Fryb----B??????
%Frxc,Fryc----C??????
%Frd Mrd----D??????(????????????????????

function [Frxb,Fryb,Frxc,Fryc,Frd, Mrd] = fRRP2(xb,yb,xc,yc,xsi,ysi,xsj,ysj,...
ddxsi,ddysi,ddxsj,ddysj,ddthetai,phij,...
mi,mj,Ji,Fpxi,Fpyi,Ti,Fpxj,Fpyj,Tj)
g = 9.8;

%???i????????????????????
Fxi = Fpxi - mi*ddxsi;
Fyi = Fpyi - mi*ddysi - mi*g;
Mfi = Ti - Ji*ddthetai;

%???j????????????????????
Fxj = Fpxj - mj*ddxsj;
Fyj = Fpyj - mj*ddysj - mj*g;
Mfj = Tj; %?????????

%????????
FT = Fxi*(yc - ysi) - Fyi*(xc - xsi) + Mfi;

%??
Frd = ((Fxi + Fxj)*(yc - yb) - (Fyi + Fyj)*(xc - xb) - FT)/((xc - xb)*cos(phij) ...
+(yc - yb)*sin(phij));

%C??????
Frxc = Frd*sin(phij) - Fxj;
Fryc = -Frd*cos(phij) - Fyj;

%B??????
Frxb = Frd*sin(phij) - Fxj -Fxi;
Fryb = -Frd*cos(phij) - Fyj -Fyi;
Mrd = Fyj*(xc - xsj) - Fxj*(yc - ysj) - Mfj;

end