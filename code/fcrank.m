
%input
%xa,ya-----A????
%xb,yb---B????
%xsi,ysi---?????si??
%ddxsi,ddysi--?????????
%mi --- i????
%Ji --- i??????
%Frxb,Fryb----B??????
%Fpxi,Fpyi----????????
%Ti---?????????

%output
%Frxa,Frya----A??????
%Ty---??????????

function [Ty,Frxa,Frya] = ...
fcrank( xa,ya,xb,yb,xsi,ysi,ddxsi,ddysi,ddthetai,mi,Ji,Frxb,Fryb,Fpxi,Fpyi,Ti)

g = 9.8;
Fxi = Fpxi - mi*ddxsi;
Fyi = Fpyi - mi*ddysi - mi*g;
Mfi = Ti - Ji*ddthetai;
Frxa = Frxb - Fxi;
Frya = Fryb - Fyi;
Ty = Fryb*(xb - xa) - Frxb*(yb - ya) + Fxi*(ysi - ya) - Fyi*(xsi - xa) - Mfi;
end