%RRR 2????????

%input
%xb,yb---B????
%xc,yc-----C????
%xd,yd-----D????
%xsi,ysi---i?????si??
%xsj,ysj---j?????sj??
%ddxsi,ddysi---i?????si????
%ddxsj,ddysj---j?????sj????
%ddthetai ---i??????
%ddthetaj ---j??????
%mi,mj---??i,j???
%Ji,Jj---??i,j?????
%Fpxi,Fpyi----???i???????
%Ti---???i??????
%Fpxj,Fpyj----???j???????
%Tj---???j??????
%

%output
%Frxb,Fryb----B??????
%Frxc,Fryc----C??????
%Frxd,Fryd----D??????

function [Frxb,Fryb,Frxc,Fryc,Frxd,Fryd] = fRRR2(xb,yb,xc,yc,xd,yd,xsi,ysi,xsj,ysj,...
ddxsi,ddysi,ddxsj,ddysj,ddthetai,ddthetaj,...
mi,mj,Ji,Jj,Fpxi,Fpyi,Ti,Fpxj,Fpyj,Tj)
g = 9.8;

%???i????????????????????
Fxi = Fpxi - mi*ddxsi;
Fyi = Fpyi - mi*ddysi - mi*g;
Mfi = Ti - Ji*ddthetai;

%???j????????????????????
Fxj = Fpxj - mj*ddxsj;
Fyj = Fpyj - mj*ddysj - mj*g;
Mfj = Tj - Jj*ddthetaj;

%??B?C?D????????

%????????
FTi = Fxi*(ysi - yb) - Fyi*(xsi -xb) - Mfi;
FTj = Fxj*(ysj - yd) - Fyj*(xsj -xd) - Mfj;
GG = (xc - xd)*(yc - yb) - (yc - yd)*(xc - xb);

%C???
Frxc = (FTi*(xc - xd) + FTj*(xc - xb))/GG;
Fryc = (FTi*(yc - yd) + FTj*(yc - yb))/GG;

%B???
Frxb = Frxc - Fxi;
Fryb = Fryc - Fyi;

%D???
Frxd = -Frxc - Fxj;
Fryd = -Fryc - Fyj;
end